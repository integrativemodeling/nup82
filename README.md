These scripts demonstrate the use of [IMP](https://integrativemodeling.org), [MODELLER](https://salilab.org/modeller), and [PMI](https://github.com/salilab/pmi) in the modeling of the Nup82 complex using DSS/EDC chemical cross-links and electron microscopy (EM) 2D class averages.

First, [MODELLER](https://salilab.org/modeller) is used to generate
initial structures for the individual components in the Nup82 complex. Then, IMP
is used to model these components using DSS/EDC crosslinks and the electron microscopy 2D class averages for the entire Nup82 complex.

The modeling protocol will work with a default build of IMP, but for most effective sampling, IMP should be built with [MPI](https://integrativemodeling.org/2.5.0/doc/ref/namespaceIMP_1_1mpi.html) so that replica exchange can be used.

## List of files and directories:

- `data`		                         contains all relevant data, input structures that were generated by MODELLER or deposited in PDB, etc.

- `template`
  
- `outputs` For reference, the models described in the Nup82 publication are
  deposited in this directory. For each of the two clusters discovered in
  the study, the cluster representative (the best scoring individual model in
  the cluster) is available in RMF format, together with the top five best
  scoring models in PDB format. An accompanying stat file contains useful
  statistics on the simulation, such as whether each of the crosslinks was
  satisfied. The localization densities, as shown in Figure 6 on the publication
  are also available, as Chimera session files.

## Running the MODELLER scripts:

## Running the IMP/PMI scripts for the Nup82 complex
List of files:
1_run_initial_random_EMclass2.sh: script that runs the PMI script 1_modeling_initial_random.py. 

Running the IMP scripts for initial stage of modeling:

1) python 1_modeling_initial_random.py -r repeats -out outputdir -em2d class_average -weight em2d_weight
The script will generate repeats number of independent and uncorrelated trajectories from different random initial configuration restrained by all information available about the system (e.g., physics, structures) and restrained by one class_average.

## Running the IMP scripts for the Nup82 complex Filtering step:

List of files:
EM2D-Filter.py: Script to compute a score for a given model against a set of class averages. 
Get-Distribution-Statistics.sh: Script to analyze the results of the filtering; requires GNUPlot and ImageMagick. 
Satisfied-Classes-Count.sh: Quick script to format the results of the analysis into a summary text file. 
Models_Selection_Threshold.py: Script to select models given a threshold (either a user input or a adaptive threshold).

Running the IMP scripts for filtering the Nup82 complex based on EM2D:

1) python EM2D-Filter.py input_rmf_file list_of_class_averages angstrom_per_pixel number_of_projections model_resolution image_resolution frame_of_rmf_to_read 
Inputs: input_rmf_file: structure to be projected and registered against class averages 
list_of_class_averages: text file listing the list of class averages.
Output: A list of score for the structure against each image (1-cross correlation).

2) bash Get-Distribution-Satistics.sh 
Inputs: List of files containing the scores. This is hard coded in the script here.
Outputs: Histogram of the score for each images given a set of models Automatically made plots for the distributions of the scores Satistics (average, standard deviation, min, max) for the score of a set of models given a class average.

List of files:
2_run_refinement.sh: script that runs the PMI script 2_modeling_allEM_except11_19.py. 

Running the IMP scripts for initial stage of modeling:

1) python 2_modeling_allEM_except11_19.py -r repeats -out outputdir -rmf starting_rmf -rmf_n rmf_frame -em2d class_average -weight em2d_weight
The script will generate repeats number of independent and uncorrelated trajectories from different random initial configuration restrained by all information available about the system (e.g., physics, structures) and all class averages

## Information

_Author(s)_: Seung Joong Kim, Ilan E. Chemmama, Riccardo Pellarin 

_Date_: October 6th, 2016

_License_: [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/)
This work is licensed under the Creative Commons Attribution-ShareAlike 4.0
International License.

_Last known good IMP version_: [![build info](https://integrativemodeling.org/systems/?sysstat=6&branch=master)](https://integrativemodeling.org/systems/) [![build info](https://integrativemodeling.org/systems/?sysstat=6&branch=develop)](https://integrativemodeling.org/systems/)

_Testable_: Yes.

_Parallelizeable_: Yes

_Publications_:
 
 \*These authors contributed equally to this work as co-first authors.
