import ihm
try:
    import ihm.reference
except ImportError:
    pass
import os

# If we're running from an SGE job, override the from_pubmed_id() and
# from_accession() functions to return cached values, since we don't have
# network access (needed to query PubMed or UniProt directly)

def mock_from_pubmed(cls, pubmed_id):
    return ihm.Citation(
            pmid=27839866,
            title='Structure and Function of the Nuclear Pore Complex '
                  'Cytoplasmic mRNA Export Platform.', journal='Cell',
            volume=167, page_range=('1215','1228.e25'), year=2016, authors=[
                   'Fernandez-Martinez J', 'Kim SJ', 'Shi Y', 'Upla P',
                   'Pellarin R', 'Gagnon M', 'Chemmama IE', 'Wang J',
                   'Nudelman I', 'Zhang W', 'Williams R', 'Rice WJ',
                   'Stokes DL', 'Zenklusen D', 'Chait BT', 'Sali A', 
                   'Rout MP'], doi='10.1016/j.cell.2016.10.028')

# Auto-generated by util/get_accession_map.py
accession_map = {
    'Q02647': {'db_code':'DYL1_YEAST', 'sequence':
        'MSDENKSTPIVKASDITDKLKEDILTISKDALDKYQLERDIAGTVKKQLDVKYGNTWHVIVGKNFG'
        'SYVTHEKGHFVYFYIGPLAFLVFKTA'},
    'P40368': {'db_code':'NUP82_YEAST', 'sequence':
        'MSQSSRLSALPIFQASLSASQSPRYIFSSQNGTRIVFIQDNIIRWYNVLTDSLYHSLNFSRHLVLD'
        'DTFHVISSTSGDLLCLFNDNEIFVMEVPWGYSNVEDVSIQDAFQIFHYSIDEEEVGPKSSIKKVLF'
        'HPKSYRDSCIVVLKEDDTITMFDILNSQEKPIVLNKPNNSFGLDARVNDITDLEFSKDGLTLYCLN'
        'TTEGGDIFAFYPFLPSVLLLNEKDLNLILNKSLVMYESLDSTTDVIVKRNVIKQLQFVSKLHENWN'
        'SRFGKVDIQKEYRLAKVQGPFTINPFPGELYDYTATNIATILIDNGQNEIVCVSFDDGSLILLFKD'
        'LEMSMSWDVDNYVYNNSLVLIERVKLQREIKSLITLPEQLGKLYVISDNIIQQVNFMSWASTLSKC'
        'INESDLNPLAGLKFESKLEDIATIERIPNLAYINWNDQSNLALMSNKTLTFQNISSDMKPQSTAAE'
        'TSISTEKSDTVGDGFKMSFTQPINEILILNDNFQKACISPCERIIPSADRQIPLKNEASENQLEIF'
        'TDISKEFLQRIVKAQTLGVSIHNRIHEQQFELTRQLQSTCKIISKDDDLRRKFEAQNKKWDAQLSR'
        'QSELMERFSKLSKKLSQIAESNKFKEKKISHGEMKWFKEIRNQILQFNSFVHSQKSLQQDLSYLKS'
        'ELTRIEAETIKVDKKSQNEWDELRKMLEIDSKIIKECNEELLQVSQEFTTKTQ'},
    'P40477': {'db_code':'NU159_YEAST', 'sequence':
        'MSSLKDEVPTETSEDFGFKFLGQKQILPSFNEKLPFASLQNLDISNSKSLFVAASGSKAVVGELQL'
        'LRDHITSDSTPLTFKWEKEIPDVIFVCFHGDQVLVSTRNALYSLDLEELSEFRTVTSFEKPVFQLK'
        'NVNNTLVILNSVNDLSALDLRTKSTKQLAQNVTSFDVTNSQLAVLLKDRSFQSFAWRNGEMEKQFE'
        'FSLPSELEELPVEEYSPLSVTILSPQDFLAVFGNVISETDDEVSYDQKMYIIKHIDGSASFQETFD'
        'ITPPFGQIVRFPYMYKVTLSGLIEPDANVNVLASSCSSEVSIWDSKQVIEPSQDSERAVLPISEET'
        'DKDTNPIGVAVDVVTSGTILEPCSGVDTIERLPLVYILNNEGSLQIVGLFHVAAIKSGHYSINLES'
        'LEHEKSLSPTSEKIPIAGQEQEEKKKNNESSKALSENPFTSANTSGFTFLKTQPAAANSLQSQSSS'
        'TFGAPSFGSSAFKIDLPSVSSTSTGVASSEQDATDPASAKPVFGKPAFGAIAKEPSTSEYAFGKPS'
        'FGAPSFGSGKSSVESPASGSAFGKPSFGTPSFGSGNSSVEPPASGSAFGKPSFGTPSFGSGNSSAE'
        'PPASGSAFGKPSFGTSAFGTASSNETNSGSIFGKAAFGSSSFAPANNELFGSNFTISKPTVDSPKE'
        'VDSTSPFPSSGDQSEDESKSDVDSSSTPFGTKPNTSTKPKTNAFDFGSSSFGSGFSKALESVGSDT'
        'TFKFGTQASPFSSQLGNKSPFSSFTKDDTENGSLSKGSTSEINDDNEEHESNGPNVSGNDLTDSTV'
        'EQTSSTRLPETPSDEDGEVVEEEAQKSPIGKLTETIKKSANIDMAGLKNPVFGNHVKAKSESPFSA'
        'FATNITKPSSTTPAFSFGNSTMNKSNTSTVSPMEEADTKETSEKGPITLKSVENPFLPAKEERTGE'
        'SSKKDHNDDPKDGYVSGSEISVRTSESAFDTTANEEIPKSQDVNNHEKSETDPKYSQHAVVDHDNK'
        'SKEMNETSKNNERSGQPNHGVQGDGIALKKDNEKENFDSNMAIKQFEDHQSSEEDASEKDSRQSSE'
        'VKESDDNMSLNSDRDESISESYDKLEDINTDELPHGGEAFKAREVSASADFDVQTSLEDNYAESGI'
        'QTDLSESSKENEVQTDAIPVKHNSTQTVKKEAVDNGLQTEPVETCNFSVQTFEGDENYLAEQCKPK'
        'QLKEYYTSAKVSNIPFVSQNSTLRLIESTFQTVEAEFTVLMENIRNMDTFFTDQSSIPLVKRTVRS'
        'INNLYTWRIPEAEILLNIQNNIKCEQMQITNANIQDLKEKVTDYVRKDIAQITEDVANAKEEYLFL'
        'MHFDDASSGYVKDLSTHQFRMQKTLRQKLFDVSAKINHTEELLNILKLFTVKNKRLDDNPLVAKLA'
        'KESLARDGLLKEIKLLREQVSRLQLEEKGKKASSFDASSSITKDMKGFKVVEVGLAMNTKKQIGDF'
        'FKNLNMAK'},
    'P14907': {'db_code':'NSP1_YEAST', 'sequence':
        'MNFNTPQQNKTPFSFGTANNNSNTTNQNSSTGAGAFGTGQSTFGFNNSAPNNTNNANSSITPAFGS'
        'NNTGNTAFGNSNPTSNVFGSNNSTTNTFGSNSAGTSLFGSSSAQQTKSNGTAGGNTFGSSSLFNNS'
        'TNSNTTKPAFGGLNFGGGNNTTPSSTGNANTSNNLFGATANANKPAFSFGATTNDDKKTEPDKPAF'
        'SFNSSVGNKTDAQAPTTGFSFGSQLGGNKTVNEAAKPSLSFGSGSAGANPAGASQPEPTTNEPAKP'
        'ALSFGTATSDNKTTNTTPSFSFGAKSDENKAGATSKPAFSFGAKPEEKKDDNSSKPAFSFGAKSNE'
        'DKQDGTAKPAFSFGAKPAEKNNNETSKPAFSFGAKSDEKKDGDASKPAFSFGAKPDENKASATSKP'
        'AFSFGAKPEEKKDDNSSKPAFSFGAKSNEDKQDGTAKPAFSFGAKPAEKNNNETSKPAFSFGAKSD'
        'EKKDGDASKPAFSFGAKSDEKKDSDSSKPAFSFGTKSNEKKDSGSSKPAFSFGAKPDEKKNDEVSK'
        'PAFSFGAKANEKKESDESKSAFSFGSKPTGKEEGDGAKAAISFGAKPEEQKSSDTSKPAFTFGAQK'
        'DNEKKTEESSTGKSTADVKSSDSLKLNSKPVELKPVSLDNKTLDDLVTKWTNQLTESASHFEQYTK'
        'KINSWDQVLVKGGEQISQLYSDAVMAEHSQNKIDQSLQYIERQQDELENFLDNFETKTEALLSDVV'
        'STSSGAAANNNDQKRQQAYKTAQTLDENLNSLSSNLSSLIVEINNVSNTFNKTTNIDINNEDENIQ'
        'LIKILNSHFDALRSLDDNSTSLEKQINSIKK'},
    'Q02630': {'db_code':'NU116_YEAST', 'sequence':
        'MFGVSRGAFPSATTQPFGSTGSTFGGQQQQQQPVANTSAFGLSQQTNTTQAPAFGNFGNQTSNSPF'
        'GMSGSTTANGTPFGQSQLTNNNASGSIFGGMGNNTALSAGSASVVPNSTAGTSIKPFTTFEEKDPT'
        'TGVINVFQSITCMPEYRNFSFEELRFQDYQAGRKFGTSQNGTGTTFNNPQGTTNTGFGIMGNNNST'
        'TSATTGGLFGQKPATGMFGTGTGSGGGFGSGATNSTGLFGSSTNLSGNSAFGANKPATSGGLFGNT'
        'TNNPTNGTNNTGLFGQQNSNTNGGLFGQQQNSFGANNVSNGGAFGQVNRGAFPQQQTQQGSGGIFG'
        'QSNANANGGAFGQQQGTGALFGAKPASGGLFGQSAGSKAFGMNTNPTGTTGGLFGQTNQQQSGGGL'
        'FGQQQNSNAGGLFGQNNQSQNQSGLFGQQNSSNAFGQPQQQGGLFGSKPAGGLFGQQQGASTFASG'
        'NAQNNSIFGQNNQQQQSTGGLFGQQNNQSQSQPGGLFGQTNQNNNQPFGQNGLQQPQQNNSLFGAK'
        'PTGFGNTSLFSNSTTNQSNGISGNNLQQQSGGLFQNKQQPASGGLFGSKPSNTVGGGLFGNNQVAN'
        'QNNPASTSGGLFGSKPATGSLFGGTNSTAPNASSGGIFGSNNASNTAATTNSTGLFGNKPVGAGAS'
        'TSAGGLFGNNNNSSLNNSNGSTGLFGSNNTSQSTNAGGLFQNNTSTNTSGGGLFSQPSQSMAQSQN'
        'ALQQQQQQQRLQIQNNNPYGTNELFSKATVTNTVSYPIQPSATKIKADERKKASLTNAYKMIPKTL'
        'FTAKLKTNNSVMDKAQIKVDPKLSISIDKKNNQIAISNQQEENLDESILKASELLFNPDKRSFKNL'
        'INNRKMLIASEEKNNGSQNNDMNFKSKSEEQETILGKPKMDEKETANGGERMVLSSKNDGEDSATK'
        'HHSRNMDEENKENVADLQKQEYSEDDKKAVFADVAEKDASFINENYYISPSLDTLSSYSLLQLRKV'
        'PHLVVGHKSYGKIEFLEPVDLAGIPLTSLGGVIITFEPKTCIIYANLPNRPKRGEGINVRARITCF'
        'NCYPVDKSTRKPIKDPNHQLVKRHIERLKKNPNSKFESYDADSGTYVFIVNHAAEQT'},
}

if 'JOB_ID' in os.environ:
    ihm.Citation.from_pubmed_id = classmethod(mock_from_pubmed)
    if hasattr(ihm, 'reference'):
        def from_acc(cls, accession):
            return cls(accession=accession, **accession_map[accession])
        ihm.reference.UniProtSequence.from_accession = classmethod(from_acc)
